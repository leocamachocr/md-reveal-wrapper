<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Presentaci√≥n Reveal.js</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Reveal.js Core -->
    <link rel="stylesheet" href="{{ reveal_cdn }}/{{ reveal_version }}/reveal.min.css">
    <link rel="stylesheet" href="{{ reveal_cdn }}/{{ reveal_version }}/theme/{{ theme }}.min.css" id="theme">

    <!-- Highlight.js CSS -->
    <link rel="stylesheet"
          href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.7.0/build/styles/{{ highlight_theme }}.min.css">

    <!-- Reveal.js Scripts -->
    <script src="{{ reveal_cdn }}/{{ reveal_version }}/reveal.min.js"></script>
    <script src="{{ reveal_cdn }}/{{ reveal_version }}/plugin/highlight/highlight.js"></script>
    <script src="{{ reveal_cdn }}/{{ reveal_version }}/plugin/math/math.min.js"></script>

    <style>
        /* ========================
           BASE
        ========================= */
        .reveal section { font-size: {{ font_base }}; text-align: left; }
        .reveal section h1 { font-size: {{ font_h1 }}; }
        .reveal section h2 { font-size: {{ font_h2 }}; }
        .reveal section h3 { font-size: {{ font_h3 }}; }
        .reveal section h4 { font-size: {{ font_h4 }}; }
        .reveal section h5 { font-size: {{ font_h5 }}; }
        .reveal section h6 { font-size: {{ font_h6 }}; }
        .reveal p       { font-size: {{ font_p }}; }
        .reveal li      { font-size: {{ font_li }}; }

        /* Listas anidadas */
        .reveal section ul { padding-left: 1.5em !important; }
        .reveal section ul ul { padding-left: 2em !important; }
        .reveal section ul ul ul { padding-left: 2.5em !important; }

        /* Im√°genes */
        .reveal section img {
            max-width: 40% !important;
            max-height: 40% !important;
            object-fit: contain;
            display: block !important;
            margin: 0 auto !important;
            cursor: zoom-in;
        }

        /* Overlay de lightbox */
        .image-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.85);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 9999;
        }
        .image-overlay img {
            width: 100%;
            height: auto;
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
            border-radius: 8px;
        }

        /* Tablas */
        .reveal table {
            border-collapse: collapse;
            margin: 20px auto;
            width: 80%;
            font-size: 0.9em;
        }
        .reveal th, .reveal td {
            border: 1px solid #ccc;
            padding: 8px 12px;
            text-align: left;
        }
        .reveal th {
            background-color: #f2f2f2;
            font-weight: bold;
        }

        /* ========================
           BREADCRUMB
        ========================= */
        .reveal .header-trail {
            position: fixed !important;
            top: 0 !important;
            left: 0 !important;
            font-size: 0.5em;
            display: flex;
            flex-wrap: nowrap;
            align-items: center;
            max-width: 65%;
            overflow: hidden;
            background: rgba(255, 255, 255, 0.85);
            backdrop-filter: blur(6px);
            border-radius: 0 0 10px 0;
            padding: 5px 10px;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.08);
            gap: 4px;
            z-index: 9999;
        }

        .reveal .header-trail .crumb {
            flex: 0 1 auto;
            min-width: 0;
            display: flex;
            align-items: center;
            overflow: hidden;
}

        .reveal .header-trail .crumb-text {
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            min-width: 0;
            max-width: 120px;
            display: inline-block;
        }

        .reveal .header-trail .crumb-separator {
            flex-shrink: 0;
            color: #aaa;
        }

        .reveal .header-trail .crumb:last-of-type .crumb-text {
            color: #222;
            max-width: none;
}

        /* ========================
           QUOTE BOXES
        ========================= */
        .reveal blockquote {
            position: relative;
            padding: 16px 20px 16px 50px;
            margin: 24px auto;
            max-width: 80%;
            border-radius: 10px;
            font-size: 1.05em;
            line-height: 1.5;
            background: #fff;
            border: 1px solid #e0e0e0;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.05);
            color: #333;
            font-style: italic;
        }

        .reveal blockquote::before {
            content: "‚ùù";
            position: absolute;
            left: 15px;
            top: 12px;
            font-size: 24px;
            color: #ccc;
            font-style: normal;
        }

        .reveal blockquote.info {
            border-left: 6px solid #2a76dd;
            background: linear-gradient(135deg, rgba(42, 118, 221, 0.08), rgba(42, 118, 221, 0.02));
            color: #1a4f99;
        }

        .reveal blockquote.info::before {
            content: "‚ÑπÔ∏è";
            font-size: 20px;
            color: #2a76dd;
        }

        .reveal blockquote.warning {
            border-left: 6px solid #e67e22;
            background: linear-gradient(135deg, rgba(230, 126, 34, 0.08), rgba(230, 126, 34, 0.02));
            color: #b35400;
        }

        .reveal blockquote.warning::before {
            content: "‚ö†Ô∏è";
            font-size: 20px;
            color: #e67e22;
        }

        .reveal blockquote.tip {
            border-left: 6px solid #27ae60;
            background: linear-gradient(135deg, rgba(39, 174, 96, 0.08), rgba(39, 174, 96, 0.02));
            color: #1e8449;
        }

        .reveal blockquote.tip::before {
            content: "üí°";
            font-size: 20px;
            color: #27ae60;
        }


    </style>
</head>
<body>
<div class="reveal">
    {% if show_header_trail == "true" %}
    <div id="header-trail" class="header-trail"></div>
    {% endif %}
    <div class="slides">
        {{ slides | safe }}
    </div>
</div>

<script>
    Reveal.initialize({
        controls: {{ enable_controls | lower }},
        progress: {{ enable_progress | lower }},
        history: {{ enable_history | lower }},
        center: {{ align_center | lower }},
        transition: '{{ transition }}',
        width: {{ width }},
        height: {{ height }},
        margin: {{ margin }},
        minScale: {{ min_scale }},
        maxScale: {{ max_scale }},
        plugins: [ RevealMath.MathJax3, RevealHighlight ]
    });

    // Lightbox para im√°genes
    Reveal.on('ready', () => {
        document.querySelectorAll('img[data-preview-image]').forEach(img => {
            img.addEventListener('click', () => {
                const overlay = document.createElement('div');
                overlay.classList.add('image-overlay');

                const fullImage = document.createElement('img');
                fullImage.src = img.src;

                overlay.appendChild(fullImage);
                overlay.addEventListener('click', () => overlay.remove());

                document.body.appendChild(overlay);
            });
        });

        if (window.hljs) {
            document.querySelectorAll('pre code').forEach(block => hljs.highlightElement(block));
        }
    });

    // Breadcrumb din√°mico
    const breadcrumb = document.getElementById("header-trail");
    Reveal.on('slidechanged', event => {
        if (breadcrumb) {
            breadcrumb.innerHTML = "";
            const trail = (event.currentSlide.getAttribute("data-breadcrumb") || "").split(">");
            trail.forEach((part, index) => {
                const span = document.createElement("span");
                span.className = "crumb";

                const text = document.createElement("span");
                text.className = "crumb-text";
                text.textContent = part.trim();
                text.title = part.trim();

                span.appendChild(text);
                breadcrumb.appendChild(span);

                if (index < trail.length - 1) {
                    const sep = document.createElement("span");
                    sep.className = "crumb-separator";
                    sep.textContent = "‚Ä∫";
                    breadcrumb.appendChild(sep);
                }
            });
        }
    });
</script>
</body>
</html>
